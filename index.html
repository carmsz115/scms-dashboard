<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCMS Professional Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --primary: #2d3436;
            --danger: #ff7675;
            --warning: #fdcb6e;
            --success: #55efc4;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--primary); padding: 40px; margin: 0; }
        
        .header { margin-bottom: 40px; }
        .header h1 { margin: 0; color: #1e3799; }
        .status-dot { height: 10px; width: 10px; background-color: var(--success); border-radius: 50%; display: inline-block; margin-right: 5px; }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; max-width: 1200px; margin: auto; }

        .card { 
            background: var(--card-bg); 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.05); 
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .label { font-size: 0.8rem; font-weight: 700; color: #636e72; text-transform: uppercase; letter-spacing: 1px; }
        .value { font-size: 3rem; font-weight: bold; margin: 15px 0; color: #2d3436; }
        
        /* Alert States */
        .card.alert-red { background: var(--danger); color: white; transform: translateY(-5px); }
        .card.alert-yellow { background: var(--warning); transform: translateY(-5px); }
        .card.alert-red .label, .card.alert-red .value { color: white; }

        #last-sync { font-size: 0.8rem; color: #b2bec3; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>SCMS Master Dashboard</h1>
        <p><span class="status-dot"></span> System Live & Monitoring</p>
    </div>

    <div class="grid">
        <div id="temp-card" class="card">
            <div class="label">Room Temp</div>
            <div class="value"><span id="temp">--</span>¬∞C</div>
            <div id="temp-msg">Normal</div>
        </div>

        <div class="card">
            <div class="label">Air Humidity</div>
            <div class="value"><span id="humid">--</span>%</div>
        </div>

        <div id="light-card" class="card">
            <div class="label">Environment Light</div>
            <div class="value" id="light-val" style="font-size: 1.5rem;">WAITING...</div>
        </div>

        <div id="motion-card" class="card">
            <div class="label">Focus Status</div>
            <div class="value" id="motion-val" style="font-size: 1.5rem;">ANALYZING...</div>
        </div>
    </div>

    <p id="last-sync">Waiting for cloud data...</p>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAmpXrg4DnoW2aH6BFLYERZpF-a_sOQsjw",
            databaseURL: "https://scms-db4c9-default-rtdb.firebaseio.com"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("study");

        db.on("value", (snapshot) => {
            const data = snapshot.val();
            if(!data) return;

            // Update Values
            document.getElementById("temp").innerText = data.temp.toFixed(1);
            document.getElementById("humid").innerText = data.humidity.toFixed(0);
            
            // 1. Temperature Alert (matches ESP32 32¬∞C limit)
            const tCard = document.getElementById("temp-card");
            if(data.temp > 32) {
                tCard.classList.add("alert-red");
                document.getElementById("temp-msg").innerText = "HOT: ALARM ON";
            } else {
                tCard.classList.remove("alert-red");
                document.getElementById("temp-msg").innerText = "Optimal";
            }

            // 2. Light Alert (1 = Dark)
            const lCard = document.getElementById("light-card");
            const lVal = document.getElementById("light-val");
            if(data.light == 1) {
                lCard.classList.add("alert-red");
                lVal.innerText = "TOO DARK! üåô";
            } else {
                lCard.classList.remove("alert-red");
                lVal.innerText = "BRIGHT ‚òÄÔ∏è";
            }

            // 3. Motion Alert (Fidgeting)
            const mCard = document.getElementById("motion-card");
            const mVal = document.getElementById("motion-val");
            if(data.fidgeting) {
                mCard.classList.add("alert-yellow");
                mVal.innerText = "FIDGETING!";
            } else {
                mCard.classList.remove("alert-yellow");
                mVal.innerText = "FOCUSED";
            }

            document.getElementById("last-sync").innerText = "Last Update: " + new Date().toLocaleTimeString();
        });
    </script>
</body>
</html>
